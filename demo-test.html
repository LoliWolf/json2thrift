<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>树形编辑器演示</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="tree-editor.css">
    <style>
        body {
            margin: 20px;
            font-family: Arial, sans-serif;
        }
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .demo-json {
            background: #f5f5f5;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .tree-demo {
            border: 1px solid #ddd;
            border-radius: 8px;
            height: 600px;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1>树形Thrift IDL编辑器演示</h1>
        
        <h3>测试JSON数据：</h3>
        <div class="demo-json" id="demoJson">{
  "userId": 12345,
  "userName": "张三",
  "isActive": true,
  "score": 98.5,
  "tags": ["student", "active", "premium"],
  "profile": {
    "age": 20,
    "email": "zhangsan@example.com",
    "address": {
      "city": "北京",
      "zipCode": "100000"
    }
  },
  "orders": [
    {
      "orderId": "ORD-001",
      "amount": 299.99,
      "items": [
        {
          "productId": "PROD-001",
          "quantity": 2,
          "price": 149.99
        }
      ]
    }
  ]
}</div>
        
        <h3>树形编辑器：</h3>
        <div class="tree-demo" id="treeEditor"></div>
        
        <div style="margin-top: 20px;">
            <button onclick="generateThrift()" class="btn btn-primary">生成Thrift IDL</button>
            <button onclick="exportThrift()" class="btn btn-success">导出</button>
            <button onclick="resetChanges()" class="btn btn-secondary">重置</button>
        </div>
        
        <div style="margin-top: 20px;">
            <h4>生成的Thrift IDL：</h4>
            <textarea id="generatedThrift" style="width: 100%; height: 300px; font-family: monospace; font-size: 12px;" readonly></textarea>
        </div>
    </div>

    <script src="tree-editor.js"></script>
    <script>
        let demoEditor;
        
        function initDemo() {
            demoEditor = new ThriftTreeEditor('treeEditor');
            const demoJson = document.getElementById('demoJson').textContent;
            try {
                const jsonData = JSON.parse(demoJson);
                demoEditor.loadFromJson(jsonData);
            } catch (error) {
                console.error('JSON解析错误:', error);
            }
        }
        
        function generateThrift() {
            if (demoEditor) {
                const thriftIDL = demoEditor.generateThriftIDL();
                document.getElementById('generatedThrift').value = thriftIDL;
            }
        }
        
        function exportThrift() {
            if (demoEditor) {
                demoEditor.exportThrift();
            }
        }
        
        function resetChanges() {
            if (demoEditor) {
                demoEditor.resetChanges();
            }
        }
        
        // 页面加载完成后初始化
        window.addEventListener('load', initDemo);
    </script>
</body>
</html>